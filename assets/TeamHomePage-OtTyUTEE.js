import{j as Y,g as j}from"./team-BNmmgQOH.js";import{h as F}from"./moment-BLMuvzoS.js";import{d as M,e as l,r as o,c as T,o as g,a as n,w as t,F as b,l as R,f as q,h as i,t as w,s as A}from"./index-BR_c7jHa.js";const $=M({__name:"TeamHomePage",setup(E){const r=l(!1),u=l(null),d=l(!1),m=l(!1),p=l(!1),f=l([]),c=l(void 0),v={pageNum:1,pageSize:10,expireTime:F(new Date).format("YYYY-MM-DD")},k=["公开","私有","加密"],N=s=>{s.status===2?(u.value=s,r.value=!0):y(s)},V=async()=>{u.value&&(await y(u.value),r.value=!1,c.value=void 0,u.value=null)},y=async s=>{const e={teamId:s.id,password:c.value};await Y(e).then(()=>{A({type:"primary",message:"加入成功"})})},D=async()=>{m.value=!1,v.pageNum=1,await h()},h=async()=>{d.value=!0;try{const e=(await j(v)).data;console.log(e),p.value&&(f.value=[],p.value=!1),f.value.push(...e),e.length<v.pageSize?m.value=!0:v.pageNum++}finally{d.value=!1}};return(s,e)=>{const _=o("van-tag"),x=o("van-button"),C=o("van-card"),S=o("van-config-provider"),L=o("van-list"),U=o("van-pull-refresh"),z=o("van-field"),B=o("van-form"),J=o("van-dialog");return g(),T(b,null,[n(U,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=a=>p.value=a),onRefresh:D,style:{"margin-top":"4px"}},{default:t(()=>[n(L,{loading:d.value,"onUpdate:loading":e[0]||(e[0]=a=>d.value=a),finished:m.value,"finished-text":"没有更多了",onLoad:h},{default:t(()=>[n(S,{"theme-vars":{cardBackground:"white"}},{default:t(()=>[(g(!0),T(b,null,R(f.value,a=>(g(),q(C,{key:a.id,title:a.name,thumb:a.creator?.avatarUrl,desc:a.description?a.description.slice(0,20)+"...":"",style:{"box-shadow":"2px 2px 2px rgba(0, 0, 0, 0.1)"}},{tags:t(()=>[n(_,{plain:"",type:"primary"},{default:t(()=>[i("最大人数: "+w(a.maxNum),1)]),_:2},1024),n(_,{plain:"",type:"success"},{default:t(()=>[i(" 到期时间: "+w(a.expireTime?.toLocaleString().slice(0,10)),1)]),_:2},1024),n(_,{plain:"",type:"warning"},{default:t(()=>[i(w(k[a.status]),1)]),_:2},1024)]),footer:t(()=>[n(x,{size:"small",type:"success",onClick:H=>N(a)},{default:t(()=>[...e[4]||(e[4]=[i("加入队伍",-1)])]),_:2},1032,["onClick"]),n(x,{size:"small",type:"default"},{default:t(()=>[...e[5]||(e[5]=[i("查看详情",-1)])]),_:1})]),_:2},1032,["title","thumb","desc"]))),128))]),_:1})]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"]),n(J,{show:r.value,"onUpdate:show":e[3]||(e[3]=a=>r.value=a),title:"请输入密码",onConfirm:V,"show-cancel-button":""},{default:t(()=>[n(B,null,{default:t(()=>[n(z,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=a=>c.value=a),label:"密码",type:"password"},null,8,["modelValue"])]),_:1})]),_:1},8,["show"])],64)}}});export{$ as default};
